generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id             String         @id @default(cuid())
  email          String         @unique
  password       String
  name           String
  role           Role           @default(CUSTOMER)
  country        String?
  phone          String?
  company        String?
  active         Boolean        @default(true)
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  blogPosts      BlogPost[]     @relation("BlogAuthor")
  assignedQuotes QuoteRequest[] @relation("AssignedQuotes")

  @@map("users")
}

model Product {
  id            String          @id @default(cuid())
  nameAr        String
  nameEn        String
  nameEs        String
  nameFr        String
  category      ProductCategory
  descriptionAr String
  descriptionEn String
  descriptionEs String
  descriptionFr String
  thickness     String
  finishes      String
  originCountry String
  images        Json
  slug          String          @unique
  featured      Boolean         @default(false)
  active        Boolean         @default(true)
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt

  @@map("products")
}

model BlogPost {
  id              String    @id @default(cuid())
  titleAr         String
  titleEn         String
  titleEs         String
  titleFr         String
  contentAr       String
  contentEn       String
  contentEs       String
  contentFr       String
  excerpt         String?
  excerptAr       String?
  excerptEn       String?
  excerptEs       String?
  excerptFr       String?
  metaTitle       String?
  metaDescription String?
  slug            String    @unique
  featured        Boolean   @default(false)
  published       Boolean   @default(false)
  featuredImage   String?
  views           Int       @default(0)
  tags            String?
  authorId        String?
  categoryId      String?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  category        Category? @relation("BlogCategory", fields: [categoryId], references: [id])
  author          User?     @relation("BlogAuthor", fields: [authorId], references: [id])

  @@map("blog_posts")
}

model QuoteRequest {
  id            String             @id @default(cuid())
  fullName      String
  email         String
  phone         String
  company       String?
  country       String
  city          String?
  projectType   String
  projectName   String?
  expectedDate  DateTime?
  budget        String?
  productType   String
  quantity      String
  thickness     String?
  finish        String?
  dimensions    String?
  color         String?
  message       String?
  attachments   Json?
  status        QuoteRequestStatus @default(PENDING)
  priority      Priority           @default(NORMAL)
  assignedTo    String?
  internalNotes String?
  quotedPrice   Float?
  quotedAt      DateTime?
  createdAt     DateTime           @default(now())
  updatedAt     DateTime           @updatedAt
  assignedUser  User?              @relation("AssignedQuotes", fields: [assignedTo], references: [id])
  responses     QuoteResponse[]

  @@map("quote_requests")
}

model QuoteResponse {
  id          String       @id @default(cuid())
  quoteId     String
  message     String
  attachments Json?
  isInternal  Boolean      @default(false)
  createdBy   String
  createdAt   DateTime     @default(now())
  quote       QuoteRequest @relation(fields: [quoteId], references: [id], onDelete: Cascade)

  @@map("quote_responses")
}

model ContactMessage {
  id        String        @id @default(cuid())
  name      String
  email     String
  phone     String?
  company   String?
  subject   String?
  message   String
  status    ContactStatus @default(NEW)
  readAt    DateTime?
  createdAt DateTime      @default(now())
  updatedAt DateTime      @updatedAt

  @@map("contact_messages")
}

model Newsletter {
  id             String           @id @default(cuid())
  email          String           @unique
  name           String?
  status         NewsletterStatus @default(ACTIVE)
  subscribedAt   DateTime         @default(now())
  unsubscribedAt DateTime?

  @@map("newsletter_subscribers")
}

model SiteSettings {
  id                    String   @id @default(cuid())
  companyName           String   @default("Lumerra Marble")
  companyNameAr         String   @default("شركة لوميرا للرخام")
  companyNameEs         String   @default("Lumerra Marble")
  companyNameFr         String   @default("Lumerra Marble")
  // Old logo fields (deprecated, keeping for backward compatibility)
  logoUrl               String?
  logoAlt               String   @default("Company Logo")
  logoAltAr             String   @default("شعار الشركة")
  logoAltEs             String   @default("Logo de la Empresa")
  logoAltFr             String   @default("Logo de l'Entreprise")
  darkModeLogoUrl       String?
  // Header Logo
  headerLogoUrl         String?
  headerLogoAlt         String   @default("Header Logo")
  headerLogoAltAr       String   @default("شعار الهيدر")
  headerLogoAltEs       String   @default("Logo del Encabezado")
  headerLogoAltFr       String   @default("Logo de l'En-tête")
  headerDarkModeLogoUrl String?
  // Footer Logo
  footerLogoUrl         String?
  footerLogoAlt         String   @default("Footer Logo")
  footerLogoAltAr       String   @default("شعار الفوتر")
  footerLogoAltEs       String   @default("Logo del Pie de Página")
  footerLogoAltFr       String   @default("Logo du Pied de Page")
  footerDarkModeLogoUrl String?
  faviconUrl            String?
  description           String?
  descriptionAr         String?
  descriptionEs         String?
  descriptionFr         String?
  phone                 String?
  email                 String?
  whatsapp              String?
  address               String?
  addressAr             String?
  addressEs             String?
  addressFr             String?
  facebook              String?
  instagram             String?
  linkedin              String?
  youtube               String?
  tiktok                String?
  metaTitle             String?
  metaTitleAr           String?
  metaTitleEs           String?
  metaTitleFr           String?
  metaDescription       String?
  metaDescriptionAr     String?
  metaDescriptionEs     String?
  metaDescriptionFr     String?
  keywords              String?
  keywordsAr            String?
  keywordsEs            String?
  keywordsFr            String?
  businessHours         String?
  businessHoursAr       String?
  businessHoursEs       String?
  businessHoursFr       String?
  smtpHost              String?  @default("smtp.gmail.com")
  smtpPort              Int?     @default(587)
  smtpUser              String?
  smtpPassword          String?
  smtpSecure            Boolean? @default(false)
  emailFrom             String?
  emailFromName         String?
  notificationEmail     String?
  maxImageSize          Int?     @default(5242880)
  allowedImageTypes     String?  @default("image/jpeg,image/png,image/webp,image/gif")
  imageQuality          Int?     @default(80)
  autoOptimize          Boolean? @default(true)
  thumbnailWidth        Int?     @default(300)
  thumbnailHeight       Int?     @default(300)
  maxWidth              Int?     @default(1920)
  maxHeight             Int?     @default(1080)
  googleAnalyticsId     String?
  googleTagManagerId    String?
  facebookPixelId       String?
  linkedinPartnerId     String?
  tiktokPixelId         String?
  bingAdsId             String?
  seoIndexing           Boolean? @default(true)
  seoFollowLinks        Boolean? @default(true)
  canonicalUrl          String?
  robotsTxt             String?
  privacyPolicyAr       String?
  privacyPolicyEn       String?
  privacyPolicyEs       String?
  privacyPolicyFr       String?
  termsConditionsAr     String?
  termsConditionsEn     String?
  termsConditionsEs     String?
  termsConditionsFr     String?
  copyrightText         String?  @default("© 2024 Lumerra Marble. All rights reserved.")
  fontFamily            String?  @default("Inter")
  fontSize              String?  @default("16px")
  borderRadius          String?  @default("8px")
  boxShadow             String?  @default("0 1px 3px rgba(0,0,0,0.1)")
  buttonStyle           String?  @default("rounded")
  animationsEnabled     Boolean? @default(true)
  darkModeEnabled       Boolean? @default(false)
  enableRecaptcha       Boolean? @default(true)
  recaptchaSiteKey      String?
  recaptchaSecretKey    String?
  maxLoginAttempts      Int?     @default(5)
  sessionTimeout        Int?     @default(480)
  enableTwoFactor       Boolean? @default(false)
  allowedIPs            String?
  blockedIPs            String?
  whatsappAutoReply     String?
  whatsappGreeting      String?  @default("مرحباً! كيف يمكنني مساعدتك؟")
  whatsappButtonText    String?  @default("تواصل عبر واتساب")
  whatsappShowOnMobile  Boolean? @default(true)
  whatsappShowOnDesktop Boolean? @default(true)
  whatsappPosition      String?  @default("bottom-right")
  footerDescriptionAr   String?
  footerDescriptionEn   String?
  footerDescriptionEs   String?
  footerDescriptionFr   String?
  primaryColor          String   @default("#f59000")
  secondaryColor        String   @default("#2c3e50")
  tertiaryColor         String   @default("#34495e")
  quaternaryColor       String   @default("#2c3e50")
  quinaryColor          String   @default("#ffffff")
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt

  @@map("site_settings_new")
}

model FileUpload {
  id           String   @id @default(cuid())
  filename     String
  originalName String
  mimetype     String
  size         Int
  path         String
  url          String
  uploadedBy   String?
  createdAt    DateTime @default(now())

  @@map("file_uploads")
}

model PageContent {
  id          String      @id @default(cuid())
  pageKey     String
  sectionKey  String
  contentKey  String
  valueAr     String?
  valueEn     String?
  valueEs     String?
  valueFr     String?
  contentType ContentType @default(TEXT)
  sortOrder   Int         @default(0)
  isActive    Boolean     @default(true)
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  @@unique([pageKey, sectionKey, contentKey])
  @@map("page_contents")
}

model PageSEO {
  id            String   @id @default(cuid())
  pageKey       String   @unique
  titleAr       String?
  titleEn       String?
  titleEs       String?
  titleFr       String?
  descriptionAr String?
  descriptionEn String?
  descriptionEs String?
  descriptionFr String?
  keywordsAr    String?
  keywordsEn    String?
  keywordsEs    String?
  keywordsFr    String?
  ogImageAr     String?
  ogImageEn     String?
  ogImageEs     String?
  ogImageFr     String?
  schemaMarkup  Json?
  canonicalUrl  String?
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("page_seo")
}

model Category {
  id            String       @id @default(cuid())
  type          CategoryType
  nameAr        String
  nameEn        String
  nameEs        String?
  nameFr        String?
  descriptionAr String?
  descriptionEn String?
  descriptionEs String?
  descriptionFr String?
  slug          String       @unique
  icon          String?
  color         String?
  image         String?
  sortOrder     Int          @default(0)
  isActive      Boolean      @default(true)
  parentId      String?
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
  blogPosts     BlogPost[]   @relation("BlogCategory")
  parent        Category?    @relation("CategoryHierarchy", fields: [parentId], references: [id])
  children      Category[]   @relation("CategoryHierarchy")

  @@map("categories")
}

model MediaFile {
  id           String        @id @default(cuid())
  filename     String
  originalName String
  title        String?
  altText      String?
  description  String?
  mimetype     String
  size         Int
  width        Int?
  height       Int?
  path         String
  url          String
  thumbnailUrl String?
  category     MediaCategory @default(OTHER)
  uploadedBy   String?
  isActive     Boolean       @default(true)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  @@map("media_files")
}

model SiteStats {
  id              String   @id @default(cuid())
  date            DateTime @unique @default(now())
  visitors        Int      @default(0)
  pageViews       Int      @default(0)
  uniqueVisitors  Int      @default(0)
  quoteRequests   Int      @default(0)
  contactMessages Int      @default(0)
  newSubscribers  Int      @default(0)

  @@map("site_stats")
}

enum Role {
  ADMIN
  EDITOR
  CUSTOMER
}

enum ProductCategory {
  MARBLE
  GRANITE
  QUARTZ
  SPECIAL
}

enum QuoteRequestStatus {
  PENDING
  REVIEWED
  PROCESSING
  QUOTED
  ACCEPTED
  REJECTED
  COMPLETED
  CANCELLED
}

enum Priority {
  LOW
  NORMAL
  HIGH
  URGENT
}

enum ContactStatus {
  NEW
  READ
  REPLIED
  CLOSED
}

enum NewsletterStatus {
  ACTIVE
  UNSUBSCRIBED
  BOUNCED
}

enum ContentType {
  TEXT
  RICH_TEXT
  IMAGE
  VIDEO
  AUDIO
  FILE
  JSON
  NUMBER
  BOOLEAN
  DATE
  URL
}

enum CategoryType {
  PRODUCT
  BLOG
  SERVICE
  GALLERY
  FAQ
}

enum MediaCategory {
  HERO
  PRODUCT
  GALLERY
  BLOG
  AVATAR
  LOGO
  ICON
  DOCUMENT
  OTHER
}
